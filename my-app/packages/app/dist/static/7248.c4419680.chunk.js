"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7248],{15998:(q,O,t)=>{t.d(O,{$3:()=>m,Rr:()=>M,be:()=>d});var a=t(49724);function h(y){return!!y.getFullTextFilters}function m(y){const T=y.reduce((j,B)=>({...j,...B.getCatalogFilters?B.getCatalogFilters():{}}),{}),p=y.find(h)?.getFullTextFilters();return{filter:T,fullTextFilter:p}}function M(y){const T={};return y.forEach(p=>{p instanceof a.q_||p instanceof a.N9||p instanceof a.I5||p instanceof a.z||p instanceof a.tN||p instanceof a.Kf||p instanceof a.V3||p instanceof a.gZ||Object.assign(T,p.getCatalogFilters?.()||{})}),T}function d(y){return T=>y.every(p=>!p.filterEntity||p.filterEntity(T))}},18453:(q,O,t)=>{t.d(O,{B9:()=>$,nK:()=>v});var a=t(45250),h=t.n(a),m=t(45810),M=t.n(m),d=t(14041),y=t(18690),T=t(87290),p=t(22771),j=t(71581),B=t(30043),o=t(15998),g=t(18139);const c=(0,d.createContext)(void 0),$=e=>{const u=(0,j.A)(),S=(0,g.gf)(B.v),[R,F]=(0,d.useState)({}),D=(0,y.zy)(),A=e.pagination===!0?"cursor":typeof e.pagination=="object"?e.pagination.mode??"cursor":"none",J=typeof e.pagination=="object"?e.pagination.limit??20:20,{queryParameters:b,cursor:tt,offset:nt,limit:at}=(0,d.useMemo)(()=>{const P=M().parse(D.search,{ignoreQueryPrefix:!0});let W=J;if(typeof P.limit=="string"){const n=Number.parseInt(P.limit,10);isNaN(n)||(W=n)}const s=typeof P.offset=="string"&&A==="offset"?Number.parseInt(P.offset,10):void 0;return{queryParameters:P.filters??{},cursor:typeof P.cursor=="string"&&A==="cursor"?P.cursor:void 0,offset:A==="offset"&&s&&!isNaN(s)?s:void 0,limit:W}},[A,D.search,J]),[I,V]=(0,d.useState)(tt),[_,et]=(0,d.useState)(nt),[G,it]=(0,d.useState)(at),[K,H]=(0,d.useState)(()=>({appliedFilters:{},entities:[],backendEntities:[],pageInfo:{},offset:_,limit:G})),[{loading:k,error:st},w]=(0,T.A)(async()=>{const P=(0,a.compact)(Object.values(R)),W=Object.keys(R).reduce((s,n)=>{const r=R[n];return r?.toQueryValue&&(s[n]=r.toQueryValue()),s},{});if(A!=="none")if(I){if(I!==K.appliedCursor){const s=(0,o.be)(P),n=await S.queryEntities({cursor:I,limit:G});H({appliedFilters:R,appliedCursor:I,backendEntities:n.items,entities:n.items.filter(s),pageInfo:n.pageInfo,totalItems:n.totalItems})}}else{const s=(0,o.be)(P),n=(0,o.$3)(P),r=(0,o.$3)((0,a.compact)(Object.values(K.appliedFilters)));if(A==="offset"&&(K.limit!==G||K.offset!==_)||!(0,a.isEqual)(r,n)){const i=await S.queryEntities({...n,limit:G,offset:_,orderFields:[{field:"metadata.name",order:"asc"}]});H({appliedFilters:R,backendEntities:i.items,entities:i.items.filter(s),pageInfo:i.pageInfo,totalItems:i.totalItems,limit:G,offset:_})}}else{const s=(0,o.be)(P),n=(0,o.Rr)(P),r=(0,o.Rr)((0,a.compact)(Object.values(K.appliedFilters)));if((0,a.isEqual)(r,n)){const i=K.backendEntities.filter(s);H({appliedFilters:R,backendEntities:K.backendEntities,entities:i,totalItems:i.length})}else{const i=await S.getEntities({filter:n}),l=i.items.filter(s);H({appliedFilters:R,backendEntities:i.items,entities:l,totalItems:l.length})}}if(u()){const s=M().parse(D.search,{ignoreQueryPrefix:!0}),n=M().stringify({...s,filters:W,cursor:I,offset:_,limit:G},{addQueryPrefix:!0,arrayFormat:"repeat"}),r=`${window.location.pathname}${n}`;window.history?.replaceState(null,document.title,r)}},[S,b,R,K,I,A,G,_],{loading:!0});(0,p.A)(w,10,[R,I,G,_]);const lt=(0,d.useCallback)(P=>{V(void 0),F(W=>{const s=typeof P=="function"?P(W):P;return{...W,...s}})},[]),rt=(0,d.useMemo)(()=>{if(A!=="cursor")return;const P=K.pageInfo?.prevCursor,W=K.pageInfo?.nextCursor;return{prev:P?()=>V(P):void 0,next:W?()=>V(W):void 0}},[A,K.pageInfo]),Z=(0,d.useMemo)(()=>({filters:K.appliedFilters,entities:K.entities,backendEntities:K.backendEntities,updateFilters:lt,queryParameters:b,loading:k,error:st,pageInfo:rt,totalItems:K.totalItems,limit:G,offset:_,setLimit:it,setOffset:et,paginationMode:A}),[K,lt,b,k,st,rt,G,_,A,it,et]);return d.createElement(c.Provider,{value:Z},e.children)};function v(){const e=(0,d.useContext)(c);if(!e)throw new Error("useEntityList must be used within EntityListProvider");return e}},30117:(q,O,t)=>{t.d(O,{y:()=>s});var a=t(18139),h=t(54195),m=t(40703),M=t(58007),d=t(46423),y=t(65569),T=t(5951),p=t(26343),j=t(72501),B=t(58837),o=t(9684),g=t(92483),c=t(14041),$=t(49724),v=t(18453),e=t(46343),u=t(40074),S=t(46123),R=t(96403),F=t(94223),D=t(45250),E=t(73466),A=t(30043),J=t(15998),b=t(87290),tt=function(n){return n!==Object(n)},nt=function(n,r,i){var l=(0,c.useRef)(void 0);(!l.current||!i(r,l.current))&&(l.current=r),(0,c.useEffect)(n,l.current)};const at=nt;var I=t(56307),V=t.n(I);const _=V();var et=function(n){return n!==Object(n)},G=function(n,r){at(n,r,_)};const it=G;function K(){const n=(0,a.gf)(F.K),r=(0,a.gf)(A.v),{filters:i}=(0,v.nK)(),{value:l,loading:f}=(0,E.A)(async()=>(await n.getBackstageIdentity()).ownershipEntityRefs,[]),{user:C,owners:U,...Y}=i,x=(0,J.$3)((0,D.compact)(Object.values(Y))),[{value:L,loading:Q},ct]=(0,b.A)(async X=>{const mt=H(X.owners,X.ownershipEntityRefs);if(mt===void 0)return 0;const{["metadata.name"]:vt,...N}=X.filter.filter,{totalItems:z}=await r.queryEntities({...X.filter,filter:{...N,"relations.ownedBy":mt},limit:0});return z},[],{loading:!0});return it(()=>{Object.keys(x.filter).length!==0&&l!==void 0&&ct({ownershipEntityRefs:l,owners:U,filter:x})},[l,U,x]),{count:L,loading:f||Q,filter:(0,c.useMemo)(()=>$.tN.owned(l??[]),[l]),ownershipEntityRefs:l}}function H(n,r){if(r===void 0)return;const i=n?.values??[];if(i.length){const l=(0,D.intersection)(i,r);return l.length===0?void 0:l}return r}function k(){const n=(0,a.gf)(A.v),{filters:r}=(0,v.nK)(),i=(0,c.useRef)(),l=(0,c.useMemo)(()=>{const{user:U,...Y}=r,x=(0,D.compact)(Object.values(Y)),L=(0,J.$3)(x),Q={...L,limit:0};return Object.keys(L.filter).length===0?(i.current=void 0,i.current):(0,D.isEqual)(Q,i.current)?i.current:(i.current=Q,Q)},[r]),{value:f,loading:C}=(0,E.A)(async()=>{if(l===void 0)return 0;const{totalItems:U}=await n.queryEntities(l);return U},[l]);return{count:f,loading:C}}var st=t(78560),w=t(44861);function lt(){const n=(0,a.gf)(A.v),{filters:r}=(0,v.nK)(),{starredEntities:i}=(0,w.I)(),l=(0,c.useRef)(),f=(0,c.useMemo)(()=>{const{user:x,...L}=r,Q=(0,D.compact)(Object.values(L)),ct=(0,J.$3)(Q),X={...ct,filter:{...ct.filter,["metadata.name"]:Array.from(i).map(mt=>(0,st.KU)(mt).name)},limit:1e3};return(0,D.isEqual)(X,l.current)?l.current:(l.current=X,X)},[r,i]),{value:C,loading:U}=(0,E.A)(async()=>i.size?(await n.queryEntities(f)).items.map(L=>(0,st.U2)({kind:L.kind,namespace:L.metadata.namespace,name:L.metadata.name})).filter(L=>i.has(L)).length:0,[f,i]),Y=(0,c.useMemo)(()=>$.tN.starred(Array.from(i)),[i]);return{count:C,loading:U,filter:Y}}var rt=t(10265),Z=t(80084);const P=(0,B.A)(n=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:n.spacing(1,0,1,0)},title:{margin:n.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:n.palette.text.primary},menuItem:{minHeight:n.spacing(6)},groupWrapper:{margin:n.spacing(1,1,2,1)}}),{name:"CatalogReactUserListPicker"});function W(n,r){return[{name:r("userListPicker.personalFilter.title"),items:[{id:"owned",label:r("userListPicker.personalFilter.ownedLabel"),icon:o.A},{id:"starred",label:r("userListPicker.personalFilter.starredLabel"),icon:g.Gg}]},{name:n,items:[{id:"all",label:r("userListPicker.orgFilterAllLabel")}]}]}const s=n=>{const{initialFilter:r,availableFilters:i}=n,l=P(),f=(0,a.gf)(h.U),{t:C}=(0,rt.i)(Z.j),U=f.getOptionalString("organization.name")??C("userListPicker.defaultOrgName"),{filters:Y,updateFilters:x,queryParameters:{kind:L,user:Q}}=(0,v.nK)(),ct=["starred","all"],ft=W(U,C).map(ut=>({...ut,items:ut.items.filter(({id:ot})=>["group","user"].some(ht=>ht===L)?ct.includes(ot):!i||i.includes(ot))})).filter(({items:ut})=>!!ut.length),{count:X,loading:mt,filter:vt}=K(),{count:N}=k(),{count:z,filter:dt,loading:Ot}=lt(),pt=(0,c.useMemo)(()=>[Q].flat()[0],[Q]),[Et,gt]=(0,c.useState)(pt??r),yt=(0,c.useMemo)(()=>({all:N,starred:z,owned:X}),[z,X,N]);(0,c.useEffect)(()=>{pt&&gt(pt)},[pt]);const Pt=mt||Ot;return(0,c.useEffect)(()=>{!Pt&&Et&&Et!=="all"&&yt[Et]===0&&gt("all")},[Pt,yt,Et,gt]),(0,c.useEffect)(()=>{if(!Et||Pt)return;x({user:Et==="owned"?vt:Et==="starred"?dt:$.tN.all()})},[Et,dt,vt,x,Pt]),c.createElement(m.A,{className:l.root},ft.map(ut=>c.createElement(c.Fragment,{key:ut.name},c.createElement(j.A,{variant:"subtitle2",component:"span",className:l.title},ut.name),c.createElement(m.A,{className:l.groupWrapper},c.createElement(M.A,{disablePadding:!0,dense:!0,role:"menu","aria-label":ut.name},ut.items.map((ot,ht)=>c.createElement(p.A,{role:"none presentation",key:ot.id,divider:ht!==ut.items.length-1,onClick:()=>gt(ot.id),selected:ot.id===Y.user?.value,className:l.menuItem,disabled:yt[ot.id]===0,"data-testid":`user-picker-${ot.id}`,tabIndex:0,ContainerProps:{role:"menuitem"}},ot.icon&&c.createElement(d.A,{className:l.listIcon},c.createElement(ot.icon,{fontSize:"small"})),c.createElement(T.A,null,c.createElement(j.A,{variant:"body1"},ot.label," ")),c.createElement(y.A,null,yt[ot.id]??"-"))))))))}},40941:(q,O,t)=>{t.d(O,{t:()=>W});var a=t(78560),h=t(77125),m=t(69076),M=t(86901),d=t(72501),y=t(71677),T=t(58837),p=t(7031),j=t(44148),B=t(41260),o=t(14041),g=t(18453),c=t(49724),$=t(16261);function v(s){const n=(0,$.J)(s);(0,o.useEffect)(()=>()=>{n.current()},[])}function e(s,n,r,i=0){const l=(0,o.useRef)(),f=(0,o.useRef)(),C=(0,o.useRef)(s),U=(0,o.useRef)(),Y=()=>{l.current&&(clearTimeout(l.current),l.current=void 0),f.current&&(clearTimeout(f.current),f.current=void 0)};return v(Y),(0,o.useEffect)(()=>{C.current=s},n),(0,o.useMemo)(()=>{const x=()=>{if(Y(),!U.current)return;const Q=U.current;U.current=void 0,C.current.apply(Q.this,Q.args)},L=function(...Q){l.current&&clearTimeout(l.current),U.current={args:Q,this:this},l.current=setTimeout(x,r),i>0&&!f.current&&(f.current=setTimeout(x,i))};return Object.defineProperties(L,{length:{value:s.length},name:{value:`${s.name||"anonymous"}__debounced__${r}`}}),L},[r,i,...n])}function u(s,n,r,i=0){(0,o.useEffect)(e(s,n,r,i),n)}var S=t(48108),R=t(47966),F=t(53318),D=t(18139),E=t(87290),A=t(30043);function J({enabled:s}){const n=(0,D.gf)(A.v),[r]=(0,o.useState)(async()=>{if(!s)return[];const i="relations.ownedBy";return n.getEntityFacets({facets:[i]}).then(l=>l.facets[i].map(f=>f.value).map(f=>{const{kind:C,name:U,namespace:Y}=(0,a.KU)(f);return{apiVersion:"backstage.io/v1beta1",kind:C,metadata:{name:U,namespace:Y}}}).sort((f,C)=>f.kind.localeCompare(C.kind,"en-US")||f.metadata.namespace.localeCompare(C.metadata.namespace,"en-US")||f.metadata.name.localeCompare(C.metadata.name,"en-US"))).catch(()=>[])});return(0,E.A)(async(i,l)=>{const f=await r;if(!f)return{items:[]};const C=l?.limit??20,{text:U,start:Y}=b(i),x=f.filter(Q=>at(U,Q)),L=Y+C;return{items:x.slice(0,L),...nt({entities:x,limit:L,payload:{text:U,start:L}})}},[r],{loading:!0,value:{items:[]}})}function b(s){return tt(s)&&s.cursor?JSON.parse(atob(s.cursor)):{text:s.text||"",start:0}}function tt(s){return!!s.cursor}function nt({entities:s,limit:n,payload:r}){return s.length>n?{cursor:btoa(JSON.stringify(r))}:{}}function at(s,n){const r=s.trim();return n.kind.includes(r)||n.metadata.namespace?.includes(r)||n.metadata.name.includes(r)}function I(){const s=(0,D.gf)(A.v);return(0,E.A)(async(n,r)=>{const i=n,l=n,f=r?.limit??20;if(l.cursor){const U=await s.queryEntities({cursor:l.cursor,limit:f});return{cursor:U.pageInfo.nextCursor,items:[...l.items,...U.items]}}const C=await s.queryEntities({fullTextFilter:{term:i.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:f});return{cursor:C.pageInfo.nextCursor,items:C.items}},[],{loading:!0})}var V=t(76842);function _({mode:s,initialSelectedOwnersRefs:n}){const r=s==="owners-only",i=I(),l=J({enabled:r}),[f,C]=r?l:i;return[f,C,et({enabled:!r,initialSelectedOwnersRefs:n})]}function et({enabled:s,initialSelectedOwnersRefs:n}){const r=(0,o.useRef)({}),i=(0,D.gf)(A.v),[,l]=(0,E.A)(async()=>{(await i.getEntitiesByRefs({entityRefs:n})).items.forEach(C=>{C&&(r.current[(0,a.U2)(C)]=C)})},[]);return(0,V.u)(()=>{s&&n.length>0&&l()}),{getEntity:f=>r.current[f],setEntity:f=>{r.current[(0,a.U2)(f)]=f}}}var G=t(46123),it=t(46509),K=t(96403),H=t(80084),k=t(10265),st=t(57101);const w=(0,T.A)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),lt=(0,p.A)(s=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(M.A),rt=o.createElement(B.A,{fontSize:"small"}),Z=o.createElement(j.A,{fontSize:"small"});function P(s){const n=w(),r=s.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:i}=(0,it.f)(s.entity);return o.createElement(h.A,{className:n.fullWidth},o.createElement(lt,{className:n.fullWidth,control:o.createElement(m.A,{icon:rt,checkedIcon:Z,checked:s.isSelected}),onClick:l=>l.preventDefault(),label:o.createElement(y.Ay,{title:i},o.createElement(h.A,{display:"flex",alignItems:"center"},r?o.createElement(R.A,{fontSize:"small"}):o.createElement(S.A,{fontSize:"small"}),"\xA0",o.createElement(h.A,{className:n.boxLabel},o.createElement(d.A,{noWrap:!0},i))))}))}const W=s=>{const n=w(),{mode:r="owners-only"}=s||{},{updateFilters:i,filters:l,queryParameters:{owners:f}}=(0,g.nK)(),[C,U]=(0,o.useState)(""),{t:Y}=(0,k.i)(H.j),x=(0,o.useMemo)(()=>[f].flat().filter(Boolean),[f]),[L,Q]=(0,o.useState)(x.length?x:l.owners?.values??[]),[{value:ct,loading:ft},X,mt]=_({mode:r,initialSelectedOwnersRefs:L});u(()=>X({text:C}),[C,X],250);const vt=ct?.items||[];return(0,o.useEffect)(()=>{if(x.length){const N=new c.N9(x);Q(N.values)}},[x]),(0,o.useEffect)(()=>{i({owners:L.length?new c.N9(L):void 0})},[L,i]),["user","group"].includes(l.kind?.value.toLocaleLowerCase("en-US")||"")?null:o.createElement(h.A,{className:n.root,pb:1,pt:1},o.createElement(st.Q,{label:Y("entityOwnerPicker.title"),multiple:!0,disableCloseOnSelect:!0,loading:ft,options:vt,value:L,getOptionSelected:(N,z)=>typeof z=="string"?(0,a.U2)(N)===z:N===z,getOptionLabel:N=>{const z=typeof N=="string"?mt.getEntity(N)||(0,a.KU)(N,{defaultKind:"group",defaultNamespace:"default"}):N;return(0,F.Z)(z,(0,F.S)(z))},onChange:(N,z)=>{U(""),Q(z.map(dt=>{const Ot=typeof dt=="string"?dt:(0,a.U2)(dt);return typeof dt!="string"&&mt.setEntity(dt),Ot}))},filterOptions:N=>N,renderOption:(N,{selected:z})=>o.createElement(P,{entity:N,isSelected:z}),name:"owner-picker",onInputChange:(N,z)=>{U(z)},ListboxProps:{onScroll:N=>{const z=N.currentTarget;Math.abs(z.scrollHeight-z.clientHeight-z.scrollTop)<1&&ct?.cursor&&X({items:ct.items,cursor:ct.cursor})},"data-testid":"owner-picker-listbox"},LabelProps:{className:n.label},TextFieldProps:{className:n.input}}))}},41260:(q,O,t)=>{var a,h=t(4293),m=t(78920);a={value:!0},O.A=void 0;var M=m(t(14041)),d=h(t(74044)),y=(0,d.default)(M.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");O.A=y},44148:(q,O,t)=>{var a,h=t(4293),m=t(78920);a={value:!0},O.A=void 0;var M=m(t(14041)),d=h(t(74044)),y=(0,d.default)(M.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");O.A=y},44861:(q,O,t)=>{t.d(O,{I:()=>o});var a=t(78560),h=t(18139),m=t(14041),M=t(11746),d=t(46123),y=t.n(d),T=t(9974),p=t(96403),j=t.n(p);function B(g){return typeof g=="string"?g:(0,a.U2)(g)}function o(){const g=(0,h.gf)(T.a),c=(0,M.A)((0,m.useMemo)(()=>g.starredEntitie$(),[g]),new Set),$=(0,m.useCallback)(e=>c.has(B(e)),[c]),v=(0,m.useCallback)(e=>g.toggleStarred(B(e)).then(),[g]);return{starredEntities:c,toggleStarredEntity:v,isStarredEntity:$}}},47966:(q,O,t)=>{var a,h=t(4293),m=t(78920);a={value:!0},O.A=void 0;var M=m(t(14041)),d=h(t(74044)),y=(0,d.default)(M.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");O.A=y},49724:(q,O,t)=>{t.d(O,{I5:()=>j,Kf:()=>c,N9:()=>p,V3:()=>T,gM:()=>M,gZ:()=>g,mT:()=>$,qA:()=>d,q_:()=>y,tN:()=>o,z:()=>B});var a=t(78560),h=t(97214),m=t(699);class M{constructor(e,u){this.value=e,this.label=u}getCatalogFilters(){return{kind:this.value}}toQueryValue(){return this.value}}class d{constructor(e){this.value=e}getTypes(){return Array.isArray(this.value)?this.value:[this.value]}getCatalogFilters(){return{"spec.type":this.getTypes()}}toQueryValue(){return this.getTypes()}}class y{constructor(e){this.values=e}filterEntity(e){return this.values.every(u=>(e.metadata.tags??[]).includes(u))}getCatalogFilters(){return{"metadata.tags":this.values}}toQueryValue(){return this.values}}class T{constructor(e){this.value=e}filterEntity(e){const u=this.toUpperArray(this.value.split(/\s/)),S=this.toUpperArray([e.metadata.tags]),R=this.toUpperArray([e.metadata.name,e.metadata.title,e.spec?.profile?.displayName]);for(const F of u)if(S.every(D=>D!==F)&&R.every(D=>!D.includes(F)))return!1;return!0}getFullTextFilters(){return{term:this.value,fields:["metadata.name","metadata.title","spec.profile.displayName"]}}toQueryValue(){return this.value}toUpperArray(e){return e.flat().filter(u=>!!u).map(u=>u.toLocaleUpperCase("en-US"))}}class p{values;constructor(e){this.values=e.reduce((u,S)=>{try{return u.push((0,a.U2)((0,a.KU)(S,{defaultKind:"Group"}))),u}catch{return u}},[])}getCatalogFilters(){return{"relations.ownedBy":this.values}}filterEntity(e){return this.values.some(u=>(0,m.t)(e,h.vv).some(S=>(0,a.U2)(S)===u))}toQueryValue(){return this.values}}class j{constructor(e){this.values=e}getCatalogFilters(){return{"spec.lifecycle":this.values}}filterEntity(e){return this.values.some(u=>e.spec?.lifecycle===u)}toQueryValue(){return this.values}}class B{constructor(e){this.values=e}getCatalogFilters(){return{"metadata.namespace":this.values}}filterEntity(e){return this.values.some(u=>e.metadata.namespace===u)}toQueryValue(){return this.values}}class o{constructor(e,u){this.value=e,this.refs=u}static owned(e){return new o("owned",e)}static all(){return new o("all")}static starred(e){return new o("starred",e)}getCatalogFilters(){return this.value==="owned"?{"relations.ownedBy":this.refs??[]}:this.value==="starred"?{"metadata.name":this.refs?.map(e=>(0,a.KU)(e).name)??[]}:{}}filterEntity(e){if(this.value==="starred")return this.refs?.includes((0,a.U2)(e))??!0;if(this.value==="owned"){const u=(0,m.t)(e,h.vv);return this.refs?.some(S=>u.some(R=>(0,a.U2)(R)===S))??!1}return!0}toQueryValue(){return this.value}}class g{constructor(e,u,S){this.value=e,this.isOwnedEntity=u,this.isStarredEntity=S}filterEntity(e){switch(this.value){case"owned":return this.isOwnedEntity(e);case"starred":return this.isStarredEntity(e);default:return!0}}toQueryValue(){return this.value}}class c{constructor(e){this.value=e}getCatalogFilters(){return this.value?{"metadata.annotations.backstage.io/orphan":String(this.value)}:{}}filterEntity(e){const u=e.metadata.annotations?.["backstage.io/orphan"];return u!==void 0&&this.value.toString()===u}}class ${constructor(e){this.value=e}filterEntity(e){const u=e?.status?.items?.length>0;return u!==void 0&&this.value===u}}},56420:(q,O,t)=>{t.d(O,{Y:()=>at});var a=t(95208),h=t(18139),m=t(54195),M=t(77125),d=t(64947),y=t(93453),T=t(29365),p=t(46423),j=t(5951),B=t(26343),o=t(28233),g=t(55197),c=t(58837),$=t(72501),v=t(5893),e=t(14041),u=t(45250),S=t.n(u),R=t(70209),F=t(92483),D=t(75202),E=t(89475),A=t(10265);const J=(0,c.A)({popoverList:{minWidth:260,maxWidth:400},menuItem:{whiteSpace:"normal"}},{name:"BackstageSupportButton"}),b=({icon:I})=>{const V=(0,a.n)(),_=I?V.getSystemIcon(I)??F.NT:F.NT;return e.createElement(_,null)},tt=({link:I})=>e.createElement(D.N_,{to:I.url},I.title??I.url),nt=({item:I})=>e.createElement(B.A,{button:!1},e.createElement(p.A,null,e.createElement(b,{icon:I.icon})),e.createElement(j.A,{primary:I.title,secondary:I.links?.reduce((V,_,et)=>[...V,et>0&&e.createElement("br",{key:et}),e.createElement(tt,{link:_,key:_.url})],[])}));function at(I){const{t:V}=(0,A.i)(E.O),{title:_,items:et,children:G}=I,{items:it}=(0,R.l)(),[K,H]=(0,e.useState)(!1),[k,st]=(0,e.useState)(null),w=J(),lt=(0,h.gf)(m.U).getOptionalConfig("app.support"),rt=(0,v.A)(W=>W.breakpoints.down("sm")),Z=W=>{st(W.currentTarget),H(!0)},P=()=>{H(!1)};return lt?e.createElement(e.Fragment,null,e.createElement(M.A,{display:"flex",ml:1},rt?e.createElement(T.A,{color:"primary",size:"small",onClick:Z,"data-testid":"support-button","aria-label":"Support"},e.createElement(F.NT,null)):e.createElement(d.A,{"data-testid":"support-button","aria-label":"Support",color:"primary",onClick:Z,startIcon:e.createElement(F.NT,null)},V("supportButton.title"))),e.createElement(g.Ay,{"data-testid":"support-button-popover",open:K,anchorEl:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:P},e.createElement(o.A,{className:w.popoverList,autoFocusItem:!!k},_&&e.createElement(B.A,{button:!1,alignItems:"flex-start",className:w.menuItem},e.createElement($.A,{variant:"subtitle1"},_)),e.Children.map(G,(W,s)=>e.createElement(B.A,{button:!1,alignItems:"flex-start",key:`child-${s}`,className:w.menuItem},W)),(et??it).map((W,s)=>e.createElement(nt,{item:W,key:`item-${s}`}))),e.createElement(y.A,null,e.createElement(d.A,{color:"primary",onClick:P,"aria-label":"Close"},V("supportButton.close"))))):null}},56643:(q,O,t)=>{t.d(O,{y:()=>R});var a=t(77125),h=t(58837),m=t(14041),M=t(18139),d=t(73466),y=t(30043),T=t(69076),p=t(86901),j=t(44148),B=t(41260);const o=m.createElement(B.A,{fontSize:"small"}),g=m.createElement(j.A,{fontSize:"small"});function c({selected:F}){return m.createElement(T.A,{icon:o,checkedIcon:g,checked:F})}const $=(0,m.memo)(F=>{const{selected:D,value:E,availableOptions:A,showCounts:J}=F,b=J?`${E} (${A?.[E]})`:E;return m.createElement(p.A,{control:m.createElement(c,{selected:D}),label:b,onClick:tt=>tt.preventDefault()})});var v=t(18453),e=t(15998),u=t(57101);const S=(0,h.A)({root:{},label:{textTransform:"none",fontWeight:"bold"}},{name:"CatalogReactEntityAutocompletePicker"});function R(F){const{label:D,name:E,path:A,showCounts:J,Filter:b,InputProps:tt,initialSelectedOptions:nt=[],filtersForAvailableValues:at=["kind"]}=F,I=S(),{updateFilters:V,filters:_,queryParameters:{[E]:et}}=(0,v.nK)(),G=(0,M.gf)(y.v),it=at.map(Z=>_[Z]),{value:K}=(0,d.A)(async()=>{const Z=A,{facets:P}=await G.getEntityFacets({facets:[Z],filter:(0,e.Rr)(it.filter(Boolean))});return Object.fromEntries(P[Z].map(({value:W,count:s})=>[W,s]))},[...it]),H=(0,m.useMemo)(()=>[et].flat().filter(Boolean),[et]),[k,st]=(0,m.useState)(H.length?H:_[E]?.values??nt);(0,m.useEffect)(()=>{H.length&&st(H)},[H]);const w=Object.keys(K??{}),lt=k.length&&w.length;(0,m.useEffect)(()=>{V({[E]:lt?new b(k):void 0})},[E,lt,k,b,V]);const rt=_[E];return rt&&typeof rt=="object"&&!("values"in rt)||!w.length?null:m.createElement(a.A,{className:I.root,pb:1,pt:1},m.createElement(u.Q,{multiple:!0,disableCloseOnSelect:!0,label:D,name:`${String(E)}-picker`,options:w,value:k,TextFieldProps:tt,onChange:(Z,P)=>st(P),renderOption:(Z,{selected:P})=>m.createElement($,{selected:P,value:Z,availableOptions:K,showCounts:!!J})}))}},56829:(q,O,t)=>{t.d(O,{m:()=>p});var a=t(58837),h=t(14041),m=t(49724),M=t(56643),d=t(80084),y=t(10265);const T=(0,a.A)({input:{}},{name:"CatalogReactEntityTagPicker"}),p=j=>{const B=T(),{t:o}=(0,y.i)(d.j);return h.createElement(M.y,{label:o("entityTagPicker.title"),name:"tags",path:"metadata.tags",Filter:m.q_,showCounts:j.showCounts,InputProps:{className:B.input}})}},57101:(q,O,t)=>{t.d(O,{Q:()=>D});var a=t(77125),h=t(72501),m=t(4321),M=t(87263),d=t(16249),y=t(33145),T=t(58837),p=t(7031),j=t(99703),B=t(6924),o=t(61783),g=t(14041),c=t(45250),$=t.n(c),v=t(53373),e=t.n(v);const u=(0,T.A)(E=>({root:{margin:E.spacing(1,0)},label:{position:"relative",fontWeight:"bold",fontSize:E.typography.body2.fontSize,fontFamily:E.typography.fontFamily,color:E.palette.text.primary,"& > span":{top:0,left:0,position:"absolute"}}}),{name:"BackstageAutocomplete"}),S=(0,p.A)(E=>(0,j.A)({root:{},paper:{margin:0},hasClearIcon:{},hasPopupIcon:{},focused:{},inputRoot:{marginTop:24,backgroundColor:E.palette.background.paper,"$root$hasClearIcon$hasPopupIcon &":{paddingBlock:E.spacing(.75),paddingInlineStart:E.spacing(.75)},"$root$focused &":{outline:"none"},"$root &:hover > fieldset":{borderColor:"#ced4da"},"$root$focused & > fieldset":{borderWidth:1,borderColor:E.palette.primary.main}},popupIndicator:{padding:0,margin:0,color:"#616161","&:hover":{backgroundColor:"unset"},'& [class*="MuiTouchRipple-root"]':{display:"none"}},endAdornment:{"$root$hasClearIcon$hasPopupIcon &":{right:4}},input:{"$root$hasClearIcon$hasPopupIcon &":{fontSize:E.typography.body1.fontSize,paddingBlock:E.spacing(.8125)}}}),{name:"BackstageAutocompleteBase"})(o.Ay),R=E=>g.createElement(M.A,{...E,transition:!0,placement:"bottom-start"},({TransitionProps:A})=>g.createElement(y.A,{...A,style:{transformOrigin:"0 0 0"}},g.createElement(a.A,null,E.children))),F=E=>g.createElement(m.A,{...E,elevation:8});function D(E){const{label:A,name:J,LabelProps:b,TextFieldProps:tt,...nt}=E,at=u(),I=(0,g.useCallback)(_=>g.createElement(d.A,{...(0,c.merge)(_,tt),variant:"outlined"}),[tt]),V=g.createElement(S,{size:"small",...nt,renderInput:nt.renderInput??I,popupIcon:g.createElement(B.A,{"data-testid":`${J}-expand`}),PaperComponent:F,PopperComponent:R});return g.createElement(a.A,{className:at.root},A?g.createElement(h.A,{...b,className:e()(at.label,b?.className),component:"label"},g.createElement(a.A,{component:"span"},A),V):V)}},77509:(q,O,t)=>{t.d(O,{GI:()=>$});var a=t(14041),h=t(77125),m=t(64947),M=t(73845),d=t(42899),y=t(72501),T=t(5893),p=t(54917),j=t(65859),B=t(80084),o=t(10265);const g=v=>{const e=(0,T.A)(D=>D.breakpoints.down(v.options?.drawerBreakpoint??"md"),{noSsr:!0}),u=(0,p.A)(),[S,R]=(0,a.useState)(!1),{t:F}=(0,o.i)(B.j);return e?a.createElement(a.Fragment,null,a.createElement(m.A,{style:{marginTop:u.spacing(1),marginLeft:u.spacing(1)},onClick:()=>R(!0),startIcon:a.createElement(j.A,null)},F("catalogFilter.buttonTitle")),a.createElement(M.Ay,{open:S,onClose:()=>R(!1),anchor:v.options?.drawerAnchor??"left",disableAutoFocus:!0,keepMounted:!0,variant:"temporary"},a.createElement(h.A,{m:2},a.createElement(y.A,{variant:"h6",component:"h2",style:{marginBottom:u.spacing(1)}},F("catalogFilter.title")),v.children))):a.createElement(d.A,{item:!0,lg:2},v.children)},c=v=>a.createElement(d.A,{item:!0,xs:12,lg:10},v.children),$=v=>a.createElement(d.A,{container:!0,style:{position:"relative"}},v.children);$.Filters=g,$.Content=c}}]);})();

//# sourceMappingURL=7248.c4419680.chunk.js.map